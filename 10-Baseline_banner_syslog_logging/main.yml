---
- name: Set global configurations
  hosts: devnet_ios
  gather_facts: false
  vars:
    ansible_connection: ansible.netcommon.network_cli
    ansible_network_os: cisco.ios.ios
    ansible_become: yes
    ansible_become_method: enable
  tasks:
    - name: Remove unneeded banners
      ios_banner:
        banner: "{{ item }}"
        state: absent
      loop:
        - motd
        - exec
        - incoming
    - name: Update login banner
      ios_banner:
        banner: login
        text: |
          --------------------------------------------------
          |  
          |    This banner was generated by Ansible
          |
          --------------------------------------------------
          |
          |    You are logged into {{ inventory_hostname }}
          |
          --------------------------------------------------
        state: present

    - name: Config syslog
      ios_logging:
        dest: host
        name: "{{ log_host }}"
        state: present

    - name: Configure log buffer
      ios_logging:
        dest: buffered
        level: informational
        state: present

    - name: Enable service password-encryption
      ios_config:
        lines:
          - service password-encryption
